generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}



model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  role      String   @default("user")
  createdAt DateTime @default(now())

  // Relaciones
  perfil     Perfil?
  dilemas    Dilema[]
  patrones   Patron[]
  espejos    Espejo[]
  actividades Actividad[]
  aiLogs     AiLog[]
  userTags   UserTag[]
}

model Perfil {
  id                     Int      @id @default(autoincrement())
  user                  User     @relation(fields: [userId], references: [id])
  userId                Int      @unique
  bienestar             Int
  autoconocimiento      Int
  gestionEmocional      Int
  dilemasTotales        Int      @default(0)
  creenciasTransformadas Int     @default(0)
  diasActivo            Int      @default(0)
  progresoEmocional     Int      @default(0)
  updatedAt             DateTime @updatedAt
}




model Dilema {
  id        Int       @id @default(autoincrement())
  user      User      @relation(fields: [userId], references: [id])
  userId    Int
  titulo    String
  contenido String
  createdAt DateTime  @default(now())

  respuestas Respuesta[]
  emociones  Emocion[]
  creencias  Creencia[]
  raices     Raiz[]
  tags       DilemaTag[]
}


enum MentorTipo {
  psicologo
  filosofo
  amigo
}

model Respuesta {
  id          Int       @id @default(autoincrement())
  dilema      Dilema    @relation(fields: [dilemaId], references: [id])
  dilemaId    Int
  mentorTipo  MentorTipo
  contenido   String
  createdAt   DateTime @default(now())
}



enum TipoPensamiento {
  // Creencias y juicios
  creencia
  juicio
  etiqueta
  suposicion
  interpretacion
  generalizacion
  profecia

  // Emociones
  emocion
  miedo
  culpa
  frustracion
  verguenza
  esperanza
  tristeza
  ira

  // Motivaciones e impulsos
  impulso
  necesidad
  deseo
  intencion
  objetivo
  meta
  proposito

  // Valores y moral
  valor
  norma
  ideal
  mandato

  // Pensamiento racional y narrativo
  razonamiento
  justificacion
  explicacion
  historia_personal
  recuerdo
  experiencia_pasada
  comparacion

  // Distorsiones o patrones negativos
  catastrofe
  autoexigencia
  victimismo
  desesperanza
  rumiacion
  obsesion
  negacion
}


model Pensamiento {
  id        Int              @id @default(autoincrement())
  user      User             @relation(fields: [userId], references: [id])
  userId    Int
  padre     Pensamiento?     @relation("PadreHijo", fields: [padreId], references: [id])
  padreId   Int?
  hijos     Pensamiento[]    @relation("PadreHijo")
  contenido String
  tipo      TipoPensamiento
  createdAt DateTime         @default(now())
}